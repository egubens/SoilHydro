<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SoilHydro: Van Genuchten Water Retention Curve Tools • SoilHydro</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SoilHydro: Van Genuchten Water Retention Curve Tools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SoilHydro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/vignette.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/egubens/SoilHydro.git" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SoilHydro: Van Genuchten Water Retention Curve
Tools</h1>
            <h3 data-toc-skip class="subtitle">Fitting, Diagnostics,
Hydrophysical Metrics, and Visualization</h3>
                        <h4 data-toc-skip class="author">Erick Gutierrez
/ Auburn University</h4>
            
      

      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>SoilHydro</strong> is an R package for fitting <strong>Van
Genuchten</strong> water retention curves (WRC) and computing practical
hydrophysical summaries used in soil physics and agronomy. The
package:</p>
<ul>
<li>standardizes suction units (accepts <strong>kPa</strong> or
<strong>hPa</strong>, fits internally in kPa);</li>
<li>fits the Van Genuchten model per treatment/group with bounded
L‑BFGS‑B optimization;</li>
<li>predicts water content
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta(h)</annotation></semantics></math>
on arbitrary suction grids;</li>
<li>derives <strong>water points</strong> (e.g., Field Capacity at 10
kPa, Permanent Wilting Point at 1500 kPa, <strong>Available Water
Content</strong>);</li>
<li>partitions porosity into <strong>macro/meso/micro</strong> classes
from capillarity;</li>
<li>and provides clean <strong>ggplot2</strong> visualizations for
curves and pore-size bars.</li>
</ul>
<p>We assume familiarity with basic soil physics concepts
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>r</mi></msub><mo>,</mo><msub><mi>θ</mi><mi>s</mi></msub><mo>,</mo><mi>α</mi><mo>,</mo><mi>n</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">\theta_r, \theta_s, \alpha, n, m</annotation></semantics></math>)
and laboratory WRC data.</p>
<hr>
<div class="section level3">
<h3 id="live-web-app">Live web app<a class="anchor" aria-label="anchor" href="#live-web-app"></a>
</h3>
<p>You can try <strong>all SoilHydro functions interactively in your
browser</strong>—no installation needed:</p>
<p>👉 <a href="https://3n0c6z-erick-gutierrez.shinyapps.io/SoilHydro/" class="external-link">SoilHydro
Shiny web app</a></p>
<p>The app mirrors the package workflow (fitting, prediction, water
points, pore-size classes, and visualization).</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub using devtools</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"egubens/SoilHydro"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Requires</strong>: R ≥ 3.6; Depends on base
<strong>stats</strong> and <strong>ggplot2</strong>.</p>
</div>
<div class="section level2">
<h2 id="data-requirements">Data requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h2>
<p>Your long/tidy dataset should include at least:</p>
<ul>
<li>an <strong>ID/treatment</strong> column (optional for single‑profile
fits), e.g. <code>Product</code>;</li>
<li>a <strong>theta</strong> column with volumetric water content
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
(m^3 m^{-3});</li>
<li>a <strong>suction</strong> column <code>h</code> (either
<strong>kPa</strong> or <strong>hPa</strong>).</li>
</ul>
<p>Pass the units of your raw suction column via
<code>units = "kPa"</code> or <code>"hPa"</code>.</p>
</div>
<div class="section level2">
<h2 id="the-van-genuchten-model">The Van Genuchten model<a class="anchor" aria-label="anchor" href="#the-van-genuchten-model"></a>
</h2>
<p>We model water content
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta(h)</annotation></semantics></math>
(with suction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
in <strong>kPa</strong>) as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><msub><mi>θ</mi><mi>r</mi></msub><mo>+</mo><mfrac><mrow><msub><mi>θ</mi><mi>s</mi></msub><mo>−</mo><msub><mi>θ</mi><mi>r</mi></msub></mrow><mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>n</mi></msup><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mi>m</mi></msup></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><mi>m</mi><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>,</mo><mspace width="0.278em"></mspace><mi>n</mi><mo>&gt;</mo><mn>1</mn><mo>,</mo><mspace width="0.278em"></mspace><mi>α</mi><mo>&gt;</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
theta(h) \;=\; \theta_r + \frac{\theta_s - \theta_r}{\bigl(1 + (\alpha h)^n\bigr)^m},
\quad m = 1 - \frac{1}{n}, \; n&gt;1, \; \alpha&gt;0.
</annotation></semantics></math></p>
<p>The package uses <strong>Mualem’s</strong> linkage
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>1</mn><mo>−</mo><mn>1</mn><mi>/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">m = 1 - 1/n</annotation></semantics></math>
and fits parameters by minimizing the sum of squared errors (SSE) with
<strong>L‑BFGS‑B</strong> bounds to enforce
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>s</mi></msub><mo>&gt;</mo><msub><mi>θ</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">\theta_s&gt;\theta_r</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n&gt;1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha&gt;0</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="quick-start-with-simulated-data">Quick start with simulated data<a class="anchor" aria-label="anchor" href="#quick-start-with-simulated-data"></a>
</h2>
<p>Below we simulate three treatments with “true” parameters, sample
common laboratory suctions in <strong>hPa</strong>, add small noise, and
run the full workflow.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SoilHydro</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1) "True" parameters (kPa units)</span></span>
<span><span class="va">true_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  Control     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta_r <span class="op">=</span> <span class="fl">0.05</span>, theta_s <span class="op">=</span> <span class="fl">0.42</span>, alpha <span class="op">=</span> <span class="fl">0.030</span>, n <span class="op">=</span> <span class="fl">1.42</span><span class="op">)</span>,</span>
<span>  ArtiMicro05 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta_r <span class="op">=</span> <span class="fl">0.02</span>, theta_s <span class="op">=</span> <span class="fl">0.44</span>, alpha <span class="op">=</span> <span class="fl">0.100</span>, n <span class="op">=</span> <span class="fl">1.55</span><span class="op">)</span>,</span>
<span>  Persist10   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta_r <span class="op">=</span> <span class="fl">0.04</span>, theta_s <span class="op">=</span> <span class="fl">0.46</span>, alpha <span class="op">=</span> <span class="fl">0.060</span>, n <span class="op">=</span> <span class="fl">1.50</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) Suction points (hPa)</span></span>
<span><span class="va">hPa_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span>, <span class="fl">220</span>, <span class="fl">340</span>, <span class="fl">440</span>, <span class="fl">650</span>, <span class="fl">1000</span>, <span class="fl">1500</span>, <span class="fl">3000</span>, <span class="fl">8000</span>, <span class="fl">15000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3) Generate theta(h) + noise</span></span>
<span><span class="va">sim_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">true_params</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">p</span>  <span class="op">&lt;-</span> <span class="va">true_params</span><span class="op">[[</span><span class="va">id</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">h_kPa</span> <span class="op">&lt;-</span> <span class="va">hPa_grid</span> <span class="op">/</span> <span class="fl">10</span></span>
<span>  <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu">SoilHydro</span><span class="fu">::</span><span class="fu"><a href="../reference/vg_fun_kPa.html">vg_fun_kPa</a></span><span class="op">(</span><span class="va">h_kPa</span>, <span class="va">p</span><span class="op">$</span><span class="va">theta_r</span>, <span class="va">p</span><span class="op">$</span><span class="va">theta_s</span>, <span class="va">p</span><span class="op">$</span><span class="va">alpha</span>, <span class="va">p</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">theta_noisy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">theta_s</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.006</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Product <span class="op">=</span> <span class="va">id</span>, hPa <span class="op">=</span> <span class="va">hPa_grid</span>, theta <span class="op">=</span> <span class="va">theta_noisy</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">sim_rows</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Product hPa     theta</span></span>
<span><span class="co">#&gt; 1 Control   1 0.4200000</span></span>
<span><span class="co">#&gt; 2 Control  10 0.4158624</span></span>
<span><span class="co">#&gt; 3 Control  30 0.4186704</span></span>
<span><span class="co">#&gt; 4 Control  50 0.4167058</span></span>
<span><span class="co">#&gt; 5 Control  75 0.4102049</span></span>
<span><span class="co">#&gt; 6 Control 100 0.4016040</span></span>
<span><span class="co">#&gt; 7 Control 220 0.3838196</span></span>
<span><span class="co">#&gt; 8 Control 340 0.3495873</span></span></code></pre></div>
<div class="section level3">
<h3 id="fit-per-treatment">Fit per treatment<a class="anchor" aria-label="anchor" href="#fit-per-treatment"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vg_fit_optim.html">vg_fit_optim</a></span><span class="op">(</span></span>
<span>  data  <span class="op">=</span> <span class="va">df</span>,</span>
<span>  id    <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>  theta <span class="op">=</span> <span class="st">"theta"</span>,</span>
<span>  h     <span class="op">=</span> <span class="st">"hPa"</span>,</span>
<span>  units <span class="op">=</span> <span class="st">"hPa"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fits</span></span>
<span><span class="co">#&gt;       Product .fit_ok     theta_r   theta_s      alpha        n         m</span></span>
<span><span class="co">#&gt; 1 ArtiMicro05    TRUE 0.008167154 0.4355989 0.10356957 1.503640 0.3349473</span></span>
<span><span class="co">#&gt; 2     Control    TRUE 0.047765797 0.4197565 0.02607172 1.439453 0.3052918</span></span>
<span><span class="co">#&gt; 3   Persist10    TRUE 0.018931801 0.4644555 0.07194008 1.429538 0.3004731</span></span>
<span><span class="co">#&gt;          R2        RMSE</span></span>
<span><span class="co">#&gt; 1 0.9972856 0.007207470</span></span>
<span><span class="co">#&gt; 2 0.9975671 0.004956925</span></span>
<span><span class="co">#&gt; 3 0.9989176 0.004382912</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-wrc">Plot WRC<a class="anchor" aria-label="anchor" href="#plot-wrc"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_vg_fits.html">plot_vg_fits</a></span><span class="op">(</span></span>
<span>  data      <span class="op">=</span> <span class="va">df</span>,</span>
<span>  params_df <span class="op">=</span> <span class="va">fits</span>,</span>
<span>  id        <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>  theta     <span class="op">=</span> <span class="st">"theta"</span>,</span>
<span>  h         <span class="op">=</span> <span class="st">"hPa"</span>,</span>
<span>  units     <span class="op">=</span> <span class="st">"hPa"</span>,</span>
<span>  log_x     <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="st">"Control"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/plot-wrc-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="derived-metrics-water-points-and-awc">Derived metrics: water points and AWC<a class="anchor" aria-label="anchor" href="#derived-metrics-water-points-and-awc"></a>
</h3>
<p>We define <strong>FC</strong> at 10 kPa and <strong>PWP</strong> at
1500 kPa. <strong>AWC</strong> is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>f</mi><mi>c</mi></mrow></msub><mo>−</mo><msub><mi>θ</mi><mrow><mi>p</mi><mi>w</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta_{fc} - \theta_{pwp}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vg_water_points.html">vg_water_points</a></span><span class="op">(</span><span class="va">fits</span>, id_col <span class="op">=</span> <span class="st">"Product"</span>, fc_kPa <span class="op">=</span> <span class="fl">10</span>, pwp_kPa <span class="op">=</span> <span class="fl">1500</span><span class="op">)</span></span>
<span><span class="va">wp</span></span>
<span><span class="co">#&gt;       Product  theta_fc  theta_pwp       AWC</span></span>
<span><span class="co">#&gt; 1 ArtiMicro05 0.3440217 0.04183028 0.3021914</span></span>
<span><span class="co">#&gt; 2     Control 0.4047486 0.12191947 0.2828291</span></span>
<span><span class="co">#&gt; 3   Persist10 0.4040153 0.07855736 0.3254580</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pore-size-distribution-psd">Pore-size distribution (PSD)<a class="anchor" aria-label="anchor" href="#pore-size-distribution-psd"></a>
</h3>
<p>By capillarity, the characteristic suction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
(kPa) associated with a pore of diameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
(µm) is approximated by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ψ</mi><mspace width="0.278em"></mspace><mo>≈</mo><mspace width="0.278em"></mspace><mfrac><mrow><mn>4</mn><mi>γ</mi><mo>cos</mo><msub><mi>θ</mi><mi>c</mi></msub></mrow><mi>d</mi></mfrac><mo>×</mo><msup><mn>10</mn><mrow><mi>−</mi><mn>3</mn></mrow></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\psi \;\approx\; \frac{4 \gamma \cos\theta_c}{d} \times 10^{-3},
</annotation></semantics></math></p>
<p>with surface tension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
(N m^{-1}) and contact angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\theta_c</annotation></semantics></math>.
SoilHydro defaults to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>≈</mo><mn>0.0728</mn></mrow><annotation encoding="application/x-tex">\gamma \approx 0.0728</annotation></semantics></math>
at 20 °C and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>cos</mo><msub><mi>θ</mi><mi>c</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\cos\theta_c = 1</annotation></semantics></math>.
Using cutoffs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>a</mi><mi>c</mi><mi>r</mi><mi>o</mi></mrow></msub><mo>=</mo><mn>1000</mn><mspace width="0.167em"></mspace><mi>μ</mi><mtext mathvariant="normal">m</mtext></mrow><annotation encoding="application/x-tex">d_{macro}=1000\,\mu\text{m}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>c</mi><mi>r</mi><mi>o</mi></mrow></msub><mo>=</mo><mn>10</mn><mspace width="0.167em"></mspace><mi>μ</mi><mtext mathvariant="normal">m</mtext></mrow><annotation encoding="application/x-tex">d_{micro}=10\,\mu\text{m}</annotation></semantics></math>,
the package partitions porosity into:</p>
<ul>
<li>
<strong>Macro</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&gt;</mo><mn>1000</mn><mspace width="0.167em"></mspace><mi>μ</mi><mtext mathvariant="normal">m</mtext></mrow><annotation encoding="application/x-tex">d&gt;1000\,\mu\text{m}</annotation></semantics></math>
(large, drainage/airflow);</li>
<li>
<strong>Meso</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mtext mathvariant="normal">–</mtext><mn>1000</mn><mspace width="0.167em"></mspace><mi>μ</mi><mtext mathvariant="normal">m</mtext></mrow><annotation encoding="application/x-tex">10\text{–}1000\,\mu\text{m}</annotation></semantics></math>
(plant‑available water);</li>
<li>
<strong>Micro</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&lt;</mo><mn>10</mn><mspace width="0.167em"></mspace><mi>μ</mi><mtext mathvariant="normal">m</mtext></mrow><annotation encoding="application/x-tex">d&lt;10\,\mu\text{m}</annotation></semantics></math>
(tightly held water).</li>
</ul>
<p>By default, <strong>residual water</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\theta_r</annotation></semantics></math>
is included within “micro” so that macro+meso+micro
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><msub><mi>θ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\approx \theta_s</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vg_pore_classes.html">vg_pore_classes</a></span><span class="op">(</span></span>
<span>  <span class="va">fits</span>,</span>
<span>  id_col <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>  percent_basis <span class="op">=</span> <span class="st">"theta_s"</span>,</span>
<span>  include_residual_in_micro <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">psd</span></span>
<span><span class="co">#&gt;       Product  theta_macro theta_meso theta_micro  pct_macro pct_meso pct_micro</span></span>
<span><span class="co">#&gt; 1 ArtiMicro05 0.0007378153 0.19544165   0.2394194 0.16937953 44.86735  54.96327</span></span>
<span><span class="co">#&gt; 2     Control 0.0001008961 0.05396178   0.3656938 0.02403681 12.85550  87.12047</span></span>
<span><span class="co">#&gt; 3   Persist10 0.0005316091 0.14850556   0.3154183 0.11445857 31.97412  67.91142</span></span>
<span><span class="co">#&gt;       theta_r   theta_s</span></span>
<span><span class="co">#&gt; 1 0.008167154 0.4355989</span></span>
<span><span class="co">#&gt; 2 0.047765797 0.4197565</span></span>
<span><span class="co">#&gt; 3 0.018931801 0.4644555</span></span></code></pre></div>
<div class="section level4">
<h4 id="psd-plots">PSD plots<a class="anchor" aria-label="anchor" href="#psd-plots"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_pore_classes_percent.html">plot_pore_classes_percent</a></span><span class="op">(</span><span class="va">psd</span>, id_col <span class="op">=</span> <span class="st">"Product"</span><span class="op">)</span></span>
<span><span class="va">g_vol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_pore_classes_volume.html">plot_pore_classes_volume</a></span><span class="op">(</span><span class="va">psd</span>,  id_col <span class="op">=</span> <span class="st">"Product"</span><span class="op">)</span></span>
<span><span class="va">g_pct</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/psd-plots-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_vol</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/psd-plots-2.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="detailed-workflow">Detailed workflow<a class="anchor" aria-label="anchor" href="#detailed-workflow"></a>
</h2>
<div class="section level3">
<h3 id="units-and-preprocessing">1. Units and preprocessing<a class="anchor" aria-label="anchor" href="#units-and-preprocessing"></a>
</h3>
<ul>
<li>Specify <code>units = "kPa"</code> or <code>"hPa"</code>
<strong>matching your input column</strong>.</li>
<li>Internally, SoilHydro converts to <strong>kPa</strong> for fitting;
parameters are returned with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
in kPa^{-1}.</li>
<li>Remove zero/negative suctions when plotting on log axes (the
plotting helper already does this).</li>
</ul>
</div>
<div class="section level3">
<h3 id="fitting-and-diagnostics">2. Fitting and diagnostics<a class="anchor" aria-label="anchor" href="#fitting-and-diagnostics"></a>
</h3>
<p><code><a href="../reference/vg_fit_optim.html">vg_fit_optim()</a></code> performs bounded least‑squares with
sensible starting values per group. Returned diagnostics include
<strong>R²</strong> and <strong>RMSE</strong> computed on the fitting
data.</p>
<p><strong>Tips for robust fitting</strong></p>
<ul>
<li>Make sure your dataset spans low to high suctions to identify both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\theta_s</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\theta_r</annotation></semantics></math>.</li>
<li>If a group fails to converge (<code>.fit_ok = FALSE</code>), check
units, outliers, and monotonicity of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta(h)</annotation></semantics></math>.</li>
<li>Consider fixing a minimal positive suction (e.g., replace zeros by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mrow><mi>−</mi><mn>6</mn></mrow></msup><annotation encoding="application/x-tex">10^{-6}</annotation></semantics></math>
kPa) for stability on log scales.</li>
</ul>
</div>
<div class="section level3">
<h3 id="prediction-grids">3. Prediction grids<a class="anchor" aria-label="anchor" href="#prediction-grids"></a>
</h3>
<p>Use <code><a href="../reference/vg_predict.html">vg_predict()</a></code> to predict
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
on custom suction grids (kPa or hPa). This is useful for report tables
and smooth plotting with fixed ranges.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predict on a custom kPa grid</span></span>
<span><span class="va">grid_kPa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">100</span>, by<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">110</span>, <span class="fl">1600</span>, by<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vg_predict.html">vg_predict</a></span><span class="op">(</span><span class="va">fits</span>, id_col <span class="op">=</span> <span class="st">"Product"</span>, new_h <span class="op">=</span> <span class="va">grid_kPa</span>, units <span class="op">=</span> <span class="st">"kPa"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;             ID h units     theta</span></span>
<span><span class="co">#&gt; 1  ArtiMicro05 0   kPa 0.4355989</span></span>
<span><span class="co">#&gt; 2  ArtiMicro05 1   kPa 0.4309680</span></span>
<span><span class="co">#&gt; 3  ArtiMicro05 2   kPa 0.4229618</span></span>
<span><span class="co">#&gt; 4  ArtiMicro05 3   kPa 0.4134170</span></span>
<span><span class="co">#&gt; 5  ArtiMicro05 4   kPa 0.4031521</span></span>
<span><span class="co">#&gt; 6  ArtiMicro05 5   kPa 0.3926578</span></span>
<span><span class="co">#&gt; 7  ArtiMicro05 6   kPa 0.3822386</span></span>
<span><span class="co">#&gt; 8  ArtiMicro05 7   kPa 0.3720805</span></span>
<span><span class="co">#&gt; 9  ArtiMicro05 8   kPa 0.3622920</span></span>
<span><span class="co">#&gt; 10 ArtiMicro05 9   kPa 0.3529308</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-water-points-and-awc">4. Interpreting water points and AWC<a class="anchor" aria-label="anchor" href="#interpreting-water-points-and-awc"></a>
</h3>
<p>FC at 10 kPa. PWP at 1500 kPa is conventional for many crops.
<strong>AWC</strong> helps compare treatments but should be complemented
by conductivity/retention hysteresis where available.</p>
</div>
<div class="section level3">
<h3 id="pore-size-classes">5. Pore-size classes<a class="anchor" aria-label="anchor" href="#pore-size-classes"></a>
</h3>
<p>The PSD aggregation condenses the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta(h)</annotation></semantics></math>
curve into interpretable buckets. You can change the cutoffs via
<code>d_micro_um</code> and <code>d_macro_um</code>, choose percentage
basis (<code>"theta_s"</code> vs
<code>"available" = theta_s - theta_r</code>), and decide whether to
include
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\theta_r</annotation></semantics></math>
in micro.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vg_pore_classes.html">vg_pore_classes</a></span><span class="op">(</span></span>
<span>  <span class="va">fits</span>, id_col <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>  d_micro_um <span class="op">=</span> <span class="fl">5</span>, d_macro_um <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  percent_basis <span class="op">=</span> <span class="st">"available"</span>,</span>
<span>  include_residual_in_micro <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_residual <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">psd2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Product  theta_macro theta_meso theta_micro  pct_macro pct_meso pct_micro</span></span>
<span><span class="co">#&gt; 1 ArtiMicro05 0.0020790305  0.2561696   0.1691831 0.48640062 59.93229  39.58131</span></span>
<span><span class="co">#&gt; 2     Control 0.0002733771  0.1007785   0.2709388 0.07349031 27.09168  72.83483</span></span>
<span><span class="co">#&gt; 3   Persist10 0.0014257198  0.2119398   0.2321582 0.32000990 47.57093  52.10906</span></span>
<span><span class="co">#&gt;       theta_r   theta_s theta_residual pct_residual</span></span>
<span><span class="co">#&gt; 1 0.008167154 0.4355989    0.008167154     1.910751</span></span>
<span><span class="co">#&gt; 2 0.047765797 0.4197565    0.047765797    12.840590</span></span>
<span><span class="co">#&gt; 3 0.018931801 0.4644555    0.018931801     4.249337</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualization-options">Visualization options<a class="anchor" aria-label="anchor" href="#visualization-options"></a>
</h2>
<ul>
<li>
<code>plot_vg_fits(..., log_x = TRUE)</code> draws one
<strong>ggplot</strong> per ID with observed points and a fitted
curve.</li>
<li>
<code><a href="../reference/plot_pore_classes_percent.html">plot_pore_classes_percent()</a></code> and
<code><a href="../reference/plot_pore_classes_volume.html">plot_pore_classes_volume()</a></code> produce stacked bars with
optional horizontal layout (<code>horiz = TRUE</code>).</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show two IDs side-by-side using patchwork if desired (not required by SoilHydro)</span></span>
<span><span class="co"># install.packages("patchwork")  # if needed</span></span>
<span><span class="co"># library(patchwork)</span></span>
<span><span class="co"># plots[["Control"]] + plots[["Persist10"]]</span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="vignette_files/figure-html/viz-example-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="shiny-app-soilhydro_app">Shiny app: SoilHydro_App()<a class="anchor" aria-label="anchor" href="#shiny-app-soilhydro_app"></a>
</h2>
<p>The package includes a <strong>Shiny app</strong> that lets
users:</p>
<ul>
<li>upload CSV/Excel data and map columns;</li>
<li>fit per‑ID VG parameters;</li>
<li>view tables for fits, water points, and pore classes;</li>
<li>plot WRC with observed vs fitted curves;</li>
<li>visualize PSD as percent or volume bars; and</li>
<li>download CSVs of fits and predictions.</li>
</ul>
<p>To run the app, ensure your SoilHydro functions are
installed/available, then source and launch the app:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">SoilHydro_App</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<ul>
<li>
<strong>No fits converged</strong>: verify units, remove non‑finite
values, ensure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1.2</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\theta \in [0,1.2]</annotation></semantics></math>
(or realistic bounds).</li>
<li>
<strong>R² is NaN</strong>: occurs when all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
values are identical; broaden suction range or re‑measure.</li>
<li>
<strong>Unrealistic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\alpha, n</annotation></semantics></math></strong>:
check data coverage; tighten bounds via
<code>lower</code>/<code>upper</code> in
<code><a href="../reference/vg_fit_optim.html">vg_fit_optim()</a></code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="api-quick-reference">API quick reference<a class="anchor" aria-label="anchor" href="#api-quick-reference"></a>
</h2>
<ul>
<li>
<strong>Fitting/prediction</strong>
<ul>
<li>
<code>vg_fit_optim(data, id, theta, h, units)</code> → per‑group
parameters + diagnostics.</li>
<li>
<code>vg_predict(params_df, id_col, new_h, units, filter_id)</code>
→
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta(h)</annotation></semantics></math>
table.</li>
</ul>
</li>
<li>
<strong>Derived metrics</strong>
<ul>
<li>
<code>vg_water_points(params_df, id_col, fc_kPa=10, pwp_kPa=1500)</code>
→
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>f</mi><mi>c</mi></mrow></msub><mo>,</mo><msub><mi>θ</mi><mrow><mi>p</mi><mi>w</mi><mi>p</mi></mrow></msub><mo>,</mo><mtext mathvariant="normal">AWC</mtext></mrow><annotation encoding="application/x-tex">\theta_{fc}, \theta_{pwp}, \text{AWC}</annotation></semantics></math>.</li>
<li>
<code>vg_pore_classes(params_df, id_col, d_micro_um=10, d_macro_um=1000, percent_basis=c("theta_s","available"), include_residual_in_micro=TRUE, return_residual=FALSE)</code>
→ macro/meso/micro volumes &amp; %.</li>
</ul>
</li>
<li>
<strong>Plotting</strong>
<ul>
<li>
<code>plot_vg_fits(data, params_df, id, theta, h, units, log_x=TRUE)</code>
→ WRC plots by ID.</li>
<li>
<code>plot_pore_classes_percent(psd_df, id_col, horiz=FALSE)</code>
→ stacked % bars.</li>
<li>
<code>plot_pore_classes_volume(psd_df, id_col, horiz=FALSE)</code> →
stacked volume bars.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<p>For manuscripts, record R and package versions and set a seed for any
simulation steps (as done above). Export figures with explicit sizes
(e.g., <code>ggsave(..., width=8, height=5, units='cm', dpi=300)</code>)
when preparing journal‑ready graphics.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Van Genuchten, M. Th. (1980). A closed-form equation for predicting
the hydraulic conductivity of unsaturated soils. <em>Soil Science
Society of America Journal</em>, 44, 892–898.</li>
<li>Mualem, Y. (1976). A new model for predicting the hydraulic
conductivity of unsaturated porous media. <em>Water Resources
Research</em>, 12, 513–522.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gutierrez Erick, Da Silva Andre.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
